<div class="toolbar mat-primary">
  <div class="left-section">
    <button mat-flat-button (click)="bookFileInput.click()">
      <mat-icon>add</mat-icon>
      Добавить
    </button>
    <input
      #bookFileInput
      class="book-file-input"
      type="file"
      accept="application/pdf"
      (change)="onFileInputChange()"
    />
    <app-sort-menu
      [sortOptions]="SORT_OPTIONS"
      [(sortOption)]="selectedSortOption"
      [(sortOrder)]="selectedSortOrder"
    >
    </app-sort-menu>
    <div class="toggle-view-panel">
      <button mat-icon-button (click)="setViewMode(ViewMode.List)">
        <mat-icon>view_list</mat-icon>
      </button>
      <button mat-icon-button (click)="setViewMode(ViewMode.Grid)">
        <mat-icon>grid_view</mat-icon>
      </button>
    </div>
  </div>

  <div class="right-section">
    <mat-form-field appearance="outline" subscriptSizing="dynamic">
      <mat-label>Поиск</mat-label>
      <input matInput type="text" [formControl]="search" />
    </mat-form-field>
  </div>
</div>
@switch (selectedViewMode()) {
  @case (ViewMode.List) {
    <app-book-list-view
      infiniteScroll
      [infiniteScrollDistance]="1"
      [infiniteScrollUpDistance]="1.5"
      [infiniteScrollThrottle]="50"
      [scrollWindow]="false"
      [books]="books()"
      (openItemEvent)="openBook($event)"
      (editItemEvent)="editBook($event)"
      (deleteItemEvent)="deleteBook($event)"
      (scrolled)="loadNextPage()"
      (numOfVisibleItemsChangeEvent)="handleNumOfVisibleItemsChange($event)"
    >
      <app-loading-spinner-overlay [loading]="loading()">
      </app-loading-spinner-overlay>
    </app-book-list-view>
  }
  @case (ViewMode.Grid) {
    <app-book-grid-view
      infiniteScroll
      [infiniteScrollDistance]="2"
      [infiniteScrollUpDistance]="1.5"
      [infiniteScrollThrottle]="50"
      [scrollWindow]="false"
      [books]="books()"
      (openItemEvent)="openBook($event)"
      (editItemEvent)="editBook($event)"
      (deleteItemEvent)="deleteBook($event)"
      (scrolled)="loadNextPage()"
      (numOfVisibleItemsChangeEvent)="handleNumOfVisibleItemsChange($event)"
    >
      <app-loading-spinner-overlay [loading]="loading()">
      </app-loading-spinner-overlay>
    </app-book-grid-view>
  }
}
@if (books().length === 0) {
  <div>Здесь пусто :(</div>
}
